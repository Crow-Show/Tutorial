# [**Циклы**](https://metanit.com/sharp/tutorial/2.6.php)

Циклы - это инструменты, позволяющие выполнять блок кода повторно столько раз, сколько нужно. Все циклы так или иначе выполняются одну из функций:

**Повтор**: Снова и снова делает попытку (например, переподключение).  
**Обход**: Проходит по списку (например, список пользователей).  
**Счетчик**: Просто повторяет фиксированное число раз.  
**Проверка:** Проверяет состояние (например, пришли ли данные).

Всего в C\# **4 вида** циклов. Каждый под свою задачу.

## **for**  
`**for** (действие до цикла; условие остановки цикла; действие после каждой итерации цикла.`

### **Техническое использование**  
**for** `(int i \= 0; i \< 5; i++) ` 
**Стандартная** форма for. До начала цикла **объявляется** переменная счетчика. Потом задается **условие** выключения. Как только оно становится **false** - цикл **останавливается**. **Инкремент** или декремент **после** каждой **итерации**, чтобы цикл вовремя **выключился**.

Внутри цикла можно **менять все этапы** или пропустить все этапы, пока они совпадают с шаблоном действие ; условие ; действие. Например Поставить вместо обоих действий метод **Write()**. Или **убрать все**, чтобы получить `for ( ; ; )`. В таком случае цикл будет **бесконечным**.

### **Практическое использование**  
Несмотря на техническую возможность менять шаблон, лучше не делать этого без острой необходимости и четкого понимания зачем это делаешь. Особенно не стоит добавлять в условия метода логику программы типа метода Write(). Его стоит использовать в теле цикла.

Однако for подразумевает **гибкость** в условии. **Переменная** не обязательно должна быть чисто счетчиком. Это может быть какая-то **рабочая переменная**. **Условие** также может быть **сложнее** и **зависимым** от чего-то. **Шаг** может быть не только инкрементом, а **любым**.

### **Назначение**  
**for** используется, когда заранее точно **известно количество итераций**, которые требуются. Под это и заточен его шаблон.

## **foreach**  
`foreach(тип переменная in коллекция)`

### **Техническое использование**  
`foreach(char c in “Tom”) ` 
Стандартная форма foreach. Объявляется переменная определенного типа и коллекция, которую разбирает цикл. Это может быть строка, массив, лист и тд. С каждой итерацией каждый элемент коллекции от первого к последнему записывается в переменную и рассматривается.

### **Практическое использование**  
foreach не подразумевает гибкости и тонкости. Он может только перебирать элементы коллекции строго и первого к последнему. Но, в отличии от for, полность безопасен. Не уходит в рекурсию, не дает ошибок при неверно заданном условии. Даже коллекцию менять не может, так как рассматривает не саму коллекцию, а копию.

### **Назначение**  
Для перебора элементов коллекции от первого к последнему. Без необходимости менять саму коллекцию. Например для раскладывания строки на символы char.

## **while**  
`while(условие выключения)`

### **Техническое использование**  
Задается условие для работы цикла. Пока оно `true` - цикл работает. В условие можно задать что угодно, пока оно остается логическим и способно иметь состояния true и false. Также можно использовать просто `while(true)` для бесконечного цикла.

### **Практическое использование**  
По сути тот же for, но не имеет дополнительный настроек в виде действия до цикла и действия после итерации. Может исполнять тот же функционал, если заложить его в тело цикла.

### **Назначение**  
Может быть полным аналогом for, но не должен. Используется там, где тонкая настройка for не требуется. В основном там, где количество итераций заранее не известно. Например при попытке переподключения, где важно повторять цикл до победного.

## **do while**  
```
do  
{}  
while (условие)
```
Тот же while, но условие проверяется после первого выполнения цикла. Используется в тех случаях, когда цикл должен сработать хотя бы 1 итерацию.

## **Операторы**  
Внутри цикла можно использовать 2 оператора, влияющих на его работу:

**continue:** пропускает итерацию цикла. Вместо продолжения выполнения тема цикл запускает следующую итерацию.  
**break:** завершает работу цикла вне зависимости от условия его работы.

## **Важные моменты**

### **Вложенные циклы**  
Циклы внутри других циклов производят суммарно очень много итераций. Если в цикле с 5 итерациями есть вложенный цикл на 5 итераций, суммарно программа сделает 25 итераций вложенного цикла. Что влияет на скорость работы и оптимизацию. Стоит применять с осторожностью.

### **Безопасность**  
Циклы - основной источник зависаний в программе. В цикл всегда нужно закладывать условие, которые может стать ложным. Иначе цикл станет станет бесконечным и программа зависнет. На практике часто используют несколько условий для страховки:

**Счетчик попыток**: особенно актуально для while. Ограничивает количество итераций отдельным условием в теле цикла, который превышает его при помощи break.  
**Пример**: если цикл выполняет переподключение, где условие завершения - успешное переподключение, можно использовать счетчик попыток. Если за N попыток переключение не произошло, цикл выдает сообщение о том, что подключение провалилось, и завершается.

**Таймер**: там, где получения ответа занимает некоторое время из-за, к примеру, физических ограничений, польше подходит таймер времени, завершающий цикл, если результат не получен за указанное время.  
**Пример**: если цикл ждет ответа от устройства, которому нужно время на обработку и передачу обратного сигнала, таймер завершит итерацию или весь цикл, если ответ не получен в указанный срок.